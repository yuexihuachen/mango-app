{"version":3,"file":"static/js/async/src_components_search-note_searchNote_tsx.js","sources":["/Users/wangl577/Documents/project/mango-app/src/components/modal/modal.tsx","/Users/wangl577/Documents/project/mango-app/src/components/search-note/searchNote.tsx","/Users/wangl577/Documents/project/mango-app/src/utils/utils.ts"],"sourcesContent":["export default function Modal(props) {\n  const { title, content, open, onOk, onCancel } = props;\n  return (\n    <div className={`relative z-10 ${open ? '' : 'hidden'}`}>\n      <div className=\"fixed inset-0 transition-opacity bg-gray-500/20\"></div>\n      <div className=\"fixed inset-0 z-10 w-screen overflow-y-auto\">\n        <div className=\"flex items-end justify-center min-h-full p-4 text-center sm:items-center sm:p-0\">\n          <div className=\"relative overflow-hidden text-left transition-all transform bg-white rounded-lg shadow-xl sm:my-8 sm:w-full sm:max-w-lg\">\n            <div className=\"px-4 pt-5 pb-4 bg-white sm:p-6 sm:pb-4\">\n              <div className=\"sm:flex sm:items-start\">\n                <div className=\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left\">\n                  <h3 className=\"text-base font-semibold text-gray-900\">\n                    {title}\n                  </h3>\n                  <div className=\"mt-2\">\n                    <p className=\"text-sm text-gray-500\">{content}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"px-4 py-3 bg-gray-50 sm:flex sm:flex-row-reverse sm:px-6\">\n              {onOk && (\n                <button\n                  type=\"button\"\n                  onClick={onOk}\n                  className=\"inline-flex justify-center w-full px-3 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-md shadow-xs hover:bg-indigo-500 sm:ml-3 sm:w-auto\"\n                >\n                  Ok\n                </button>\n              )}\n              {onCancel && (\n                <button\n                  type=\"button\"\n                  onClick={onCancel}\n                  className=\"inline-flex justify-center w-full px-3 py-2 mt-3 text-sm font-semibold text-gray-900 bg-white rounded-md shadow-xs ring-1 ring-gray-300 ring-inset hover:bg-gray-50 sm:mt-0 sm:w-auto\"\n                >\n                  Cancel\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport httpRequest from '~/lib/httpClient';\nimport { useAppDispatch, useAppSelector } from '~/hooks';\nimport { Response, Note, SearchNoteBody } from '~/types';\nimport { searchNote, selectedNote } from '~/features/note/noteSlice';\nimport useFetch from '~/hooks/useFetch';\nimport { groupBy } from '~/utils/utils';\nimport { updateStatus } from '~/features/global/globalSlice';\nimport Modal from '~/components/modal/modal';\n\nfunction SearchNote() {\n  const dispatch = useAppDispatch();\n  const notes = useAppSelector((state) => state.note.notes);\n  const { data: categories, loading } = useFetch('/category/find');\n  const [title, setTitle] = useState<string>('');\n  const [category, setCagetory] = useState<string>('');\n  const [published, setPublished] = useState<number>(-1);\n  const [objCategory, setObjCategory] = useState({});\n  const [open, setOpen] = useState(false);\n  const [curNote, setCurNote] = useState(null);\n  const [deleteContent] = useState('确定删除当前笔记？');\n\n  const onOk = async () => {\n    setOpen(false);\n    const data = await httpRequest.post('/auth/note/delete', {\n      id: curNote.id,\n    }) as Response<Note> ;\n    if (data?.code === 0) {\n      dispatch(\n        updateStatus({\n          toast: {\n            content: '删除成功',\n            show: true,\n          },\n        }),\n      );\n      searchPosts()\n    }\n  };\n\n  const onCancel = () => {\n    setOpen(false);\n  }\n\n  useEffect(() => {\n    if (categories?.data) {\n      setObjCategory(groupBy(categories.data, 'id'));\n    }\n  }, [loading]);\n\n  const searchPosts = async () => {\n    let body: Partial<SearchNoteBody> = {};\n    if (title.length) {\n      body.title = title;\n    }\n    if (category.length) {\n      body.category = category;\n    }\n    if (published > -1) {\n      body.published = published;\n    }\n    const data = (await httpRequest.post('/note/find', body)) as Response<\n      Note[]\n    >;\n    if (data?.code === 0) {\n      dispatch(searchNote(data.data));\n    }\n  };\n\n  const deleteNote = (note: Note) => {\n    setCurNote(note);\n    setOpen(true);\n  };\n\n  const editNote = async (note: Note) => {\n    dispatch(selectedNote(note));\n    dispatch(\n      updateStatus({\n        tab: '4',\n      }),\n    );\n  };\n\n  const viewNote = async (note: Note) => {\n    dispatch(selectedNote(note));\n    dispatch(\n      updateStatus({\n        tab: '3',\n      }),\n    );\n  };\n\n  return (\n    <>\n      <div className=\"z-20 grid grid-cols-4 text-base bg-white gap-y-4\">\n        <div className=\"inline-grid items-end h-24 pr-3\">\n          <div className=\"sm:col-span-3\">\n            <div className=\"block text-sm font-medium leading-6 text-gray-900\">\n              标题\n            </div>\n            <div className=\"mt-2\">\n              <input\n                name=\"title\"\n                onChange={(e) => setTitle(e.target.value)}\n                type=\"text\"\n                autoComplete=\"given-name\"\n                value={title}\n                className=\"px-3 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\"\n              />\n            </div>\n          </div>\n        </div>\n        <div className=\"inline-grid items-end h-24 pr-3\">\n          <div className=\"block text-sm font-medium leading-6 text-gray-900\">\n            类型\n          </div>\n          <div className=\"grid mt-2\">\n            <select\n              name=\"category\"\n              autoComplete=\"category-name\"\n              value={category}\n              onChange={(e) => setCagetory(e.target.value)}\n              className=\"px-3 appearance-none row-start-1 col-start-1 block w-full text-base max-w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600\"\n            >\n              {!loading &&\n                categories.data.map((item) => {\n                  return (\n                    <option key={item.id} value={item.id}>\n                      {item.alias}\n                    </option>\n                  );\n                })}\n            </select>\n          </div>\n        </div>\n        <div className=\"inline-grid items-end h-24 pr-3\">\n          <div className=\"block text-sm font-medium leading-6 text-gray-900\">\n            是否发布\n          </div>\n          <div className=\"grid mt-2\">\n            <select\n              name=\"publish\"\n              autoComplete=\"publish-name\"\n              value={published}\n              onChange={(e) => setPublished(parseInt(e.target.value, 10))}\n              className=\"px-3 appearance-none row-start-1 col-start-1 block w-full text-base max-w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600\"\n            >\n              <option value={-1}>全部</option>\n              <option value={1}>已发布</option>\n              <option value={0}>未发布</option>\n            </select>\n          </div>\n        </div>\n        <div className=\"inline-grid items-end h-24\">\n        <button\n            type=\"button\"\n            onClick={searchPosts}\n            className=\"px-12 py-2 text-sm font-semibold text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\"\n          >\n            搜索\n          </button>\n        </div>\n        <div className=\"p-3 border-b border-gray-200\">标题</div>\n        <div className=\"p-3 border-b border-gray-200\">类别</div>\n        <div className=\"p-3 border-b border-gray-200\">是否发布</div>\n        <div className=\"p-3 border-b border-gray-200\">操作</div>\n      </div>\n      <div className=\"grid grid-cols-4 text-base pb-11\">\n        {notes.map((note) => {\n          const category = objCategory[note.category]?.alias;\n          return (\n            <React.Fragment key={note.id}>\n              <div className=\"px-3 py-6 border-b border-gray-200\">\n                {note.title}\n              </div>\n              <div className=\"px-3 py-6 border-b border-gray-200\">\n                {category}\n              </div>\n              <div className=\"px-3 py-6 border-b border-gray-200\">\n                {note.published === '1' ? '是' : '否'}\n              </div>\n              <div className=\"px-3 py-6 border-b border-gray-200 cursor-pointer\">\n                <span className=\"flex items-center ml-auto font-medium text-indigo-600\">\n                  <span\n                    onClick={() => viewNote(note)}\n                    className=\"pointer-events-auto hover:text-indigo-500\"\n                  >\n                    <img\n                      className=\"w-4 h-4\"\n                      src={`/view.svg`}\n                      alt=\"Your Company\"\n                    />\n                  </span>\n                  <span className=\"w-px h-6 mx-3 bg-slate-400/20\"></span>\n                  <span\n                    onClick={() => editNote(note)}\n                    className=\"pointer-events-auto hover:text-indigo-500\"\n                  >\n                    <img\n                      className=\"w-4 h-4\"\n                      src={`/edit.svg`}\n                      alt=\"Your Company\"\n                    />\n                  </span>\n                  <span className=\"w-px h-6 mx-3 bg-slate-400/20\"></span>\n                  <span\n                    onClick={() => deleteNote(note)}\n                    className=\"pointer-events-auto hover:text-indigo-500\"\n                  >\n                    <img\n                      className=\"w-4 h-4\"\n                      src={`/delete.svg`}\n                      alt=\"Your Company\"\n                    />\n                  </span>\n                </span>\n              </div>\n            </React.Fragment>\n          );\n        })}\n      </div>\n      <Modal\n        {...{\n          open,\n          ...{ content: deleteContent },\n          onOk,\n          onCancel\n        }}\n      />\n    </>\n  );\n}\n\nexport default SearchNote;\n","export const groupBy = (objArray, property) => {\n    return objArray.reduce((acc, obj) => {\n        const key = obj[property];\n        return {...acc, [key]: obj}\n    }, {})\n}"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;;AACA;AAAA;;;;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;;AACA;AAAA;AACA;AAAA;AACA;AAAA;;AACA;AAAA;AACA;;;;;;AAEA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;AAAA;;AACA;AAEA;AACA;AACA;AACA;;;;;;AAIA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA;AA7CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AAEA;;AAEA;AAAA;;AACA;AAAA;AACA;AAAA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AAKA;AAAA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AADA;;;;;AAIA;;;;;;;;;;;;;;;;;AAIA;AAAA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA;AAAA;;;;;;AACA;AAAA;AAAA;;;;;;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;AAIA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAIA;AAAA;AAAA;;;;;;AACA;AAAA;AAAA;;;;;;AACA;AAAA;AAAA;;;;;;AACA;AAAA;AAAA;;;;;;;;;;;;AAEA;AAAA;AACA;AACA;AAAA;AACA;;AAEA;AAAA;AACA;;;;;;AAEA;AAAA;AACA;;;;;;AAEA;AAAA;AACA;;;;;;AAEA;AAAA;AACA;AAAA;;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;AAGA;AAAA;;;;;;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;AAGA;AAAA;;;;;;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AAzCA;;;;;AAgDA;;;;;;AAEA;AAEA;AACA;AAAA;AAAA;AACA;AACA;;;;;;;;AAKA;AA7NA;;AACA;AACA;AACA;;;AAHA;AA+NA;;;;;;;;;;;;;;;;;;;;;;ACzOA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA"}